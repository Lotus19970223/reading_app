<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">

<head>
  <meta charset="UTF-8" />
  <title>採点結果 & フィードバック</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 1em;
    }

    .highlight {
      background: #fffb91;
    }
  </style>
</head>

<body>
  <h1>採点結果 & フィードバック</h1>

  <!-- 問題文 -->
  <section>
    <h2>問題文</h2>
    <!-- highlight 済み HTML をそのまま描画 -->
    <p th:utext="${feedback.highlightedPassage}"></p>
    <!-- 単語数を展開 -->
    <div th:text="|(${feedback.passageWordCount} words)|"></div>
  </section>

  <!-- 選択式問題の結果 -->
  <section>
    <h2>選択式問題の結果</h2>
    <div th:each="res : ${feedback.mcqResults}">
      <p>
        <!-- 正誤 -->
        <span th:text="${res.correct} ? '正解' : '不正解'"></span>
        <!-- 解説 -->
        <span th:text="${res.explanation}"></span>
      </p>
    </div>
  </section>

  <!-- 要約問題の採点 -->
  <section>
    <h2>要約問題の採点</h2>
    （0:無回答 1-2:悪い 3-4:いまひとつ 5-6:普通 7-8:良い 9-10:とても良い）
    <ul>
      <li th:text="${'文法: ' + feedback.summaryScores.grammarScore + '/10'}"></li>
      <li th:text="${'語彙: ' + feedback.summaryScores.vocabScore + '/10'}"></li>
      <li th:text="${'内容: ' + feedback.summaryScores.contentScore + '/10'}"></li>
    </ul>

    <!-- 文法フィードバック -->
    <h3>文法フィードバック</h3>
    <ul th:each="e : ${feedback.grammarFeedback}">
      <li th:text="|${e.grammarError} → ${e.correction}|"></li>
    </ul>
  </section>

  <!-- おまけ表現 -->
  <section>
    <h2>作文に便利な表現</h2>
    <ul th:each="phrase : ${feedback.usefulPhrases}">
      <li th:text="${phrase}"></li>
    </ul>
  </section>

  <a th:href="@{/}">トップに戻る</a>
</body>

</html>